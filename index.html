<!DOCTYPE html>

<html>
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
	<title>Reddit Images</title>

	<script src="scripts/angular.min.js"></script>
	<script src="scripts/angular-resource.min.js"></script>
	<script src="scripts/angular-sanitize.min.js"></script>
	<script src="scripts/underscore-min.js"></script>
	<script src="scripts/main.js"></script>

	<link href="http://fonts.googleapis.com/css?family=Raleway:700|Roboto:300,700" rel="stylesheet" type="text/css">
	<link href="css/fontello.css" rel="stylesheet" type="text/css">
	<link href="css/flat.css" rel="stylesheet" type="text/css">
	<link href="images/favicon.png" rel="shortcut icon" type="image/png">
</head>

<body ng-app="main" ng-controller="MainCtrl">
	<button class="back-to-top" ng-show="showBackToTop" ng-click="scrollTop()"><i class="icon-up-circled"></i></button>

	<section class="header">
		<h1>Reddit Images <i class="icon-down-open button-icon" ng-click="showSubredditsDropdown = !showSubredditsDropdown"></i></h1>

		<ul class="subreddits-dropdown" ng-show="showSubredditsDropdown">
			<li class="subreddit-dropdown"
			    ng-repeat="subreddit in subreddits"
			    ng-click="removeOpen ? removeSubreddit(subreddit) : toggleSubreddit(subreddit)"
			    ng-class="{selected: subreddit.selected}">
				{{subreddit.name}}
			</li>
		</ul>

		<ul class="subreddits">
			<li class="subreddit"
			    ng-repeat="subreddit in subreddits"
			    ng-click="removeOpen ? removeSubreddit(subreddit) : toggleSubreddit(subreddit)"
			    ng-class="{selected: subreddit.selected}">
				{{subreddit.name}}
				<button class="remove-subreddit" ng-show="removeOpen" ng-click="removeSubreddit(subreddit)"><i class="icon-cancel-circled"></i></button>
			</li>
		</ul>

		<div class="subreddit-actions">
			<div class="subreddit-controls" ng-hide="addSubredditOpen || removeOpen">
				<button class="button-icon" ng-click="openSubredditForm()"><i class="icon-plus-circled"></i></button>
				<button class="button-icon" ng-click="removeOpen = true"><i class="icon-minus-circled"></i></button>
			</div>

			<form class="add-form" ng-submit="addSubreddit()" ng-show="addSubredditOpen">
				<input type="text" class="subreddit-name-field" ng-model="newSubredditName" placeholder="subreddit name"/>
				<button class="add-button button-icon"><i class="icon-check"></i></button>
				<button onclick="return false;" class="cancel-button button-icon" ng-click="addSubredditOpen = false"><i class="icon-cancel"></i></button>
			</form>

			<button class="remove-form" ng-show="removeOpen" ng-click="removeOpen = false">
				<i class="icon-check"></i>
			</button>
		</div>
	</section>

	<ul class="listings">
		<li class="listing {{item.listing_type}}"
		    ng-repeat="item in items | orderBy:'index'"
		    ng-show="isSelected(item.subreddit.name)">

			<div ng-switch on="item.listing_type">
				<a ng-switch-when="image" class="full-image" ng-href="{{item.data.url}}" target="_blank">
					<img ng-src="{{optimiseImageUrl(item.data.url)}}" onerror="this.style.display='none'"/>
				</a>
				<a ng-switch-when="image-gif" class="full-image" ng-href="{{item.data.url}}" target="_blank">
					<img ng-src="{{item.data.url}}" onerror="this.style.display='none'"/>
				</a>
				<a ng-switch-when="image-album" class="thumbnail" ng-href="{{item.data.url}}" target="_blank">
					<img ng-src="{{item.data.thumbnail}}" ui-if="item.data.thumbnail != 'default'" onerror="this.style.display='none'" />
				</a>
				<a ng-switch-when="image-thumbnail" class="thumbnail" ng-href="{{item.data.url}}" target="_blank">
					<img ng-src="{{item.data.thumbnail}}" onerror="this.style.display='none'" />
				</a>


				<a ng-switch-when="media" class="full-image media" ng-href="{{item.data.url}}" target="_blank">
					<img ng-src="{{item.data.media.oembed.thumbnail_url}}" onerror="this.style.display='none'"/>
					<span class="play"><span></span></span>
				</a>
<!--
				<div class="video-container" ng-switch-when="media">
					<div ng-bind-html="unescape(item.data.media.oembed.html)"></div>
				</div>
-->
			</div>

			<div class="content">
				<p class="title">
					<a ng-href="{{item.data.url}}" target="_blank" ng-bind-html="item.data.title"></a>
				</p>
				

				<p ng-if="item.data.selftext_html" ng-bind-html="unescape(item.data.selftext_html)" class="self-text"></p>

				<div class="controls">
					<span class="control"><i class="icon-heart"></i><span class="control-text">{{item.data.score}}</span></span>
					<a class="control" ng-href="http://www.reddit.com{{item.data.permalink}}" target="_blank" ><i class="icon-comment"></i><span class="control-text">{{item.data.num_comments}}</span></a>
					<a class="control" ng-href="http://www.reddit.com/u/{{item.data.author}}" target="_blank"><i class="icon-user"></i><span class="control-text">{{item.data.author}}</span></a>
				</div>

			</div>

		</li>
	</ul>

</body>

</html>

